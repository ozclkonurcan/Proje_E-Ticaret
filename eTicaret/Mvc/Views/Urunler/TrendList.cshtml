@model IEnumerable<Mvc.Models.mvcTrendyolModel>

@{
    ViewBag.Title = "TrendList";
}

<style>
    #headerTitle {
        position: absolute;
        top: 0;
        left: 0;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 50px;
        background-color: #ad9c65;
        color: #fff;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 3px;
    }

    .tableSearchHeader {
        position: relative;
    }

    .tableSearch {
        display: flex;
        justify-content: end;
    }

    .tablePageNumber {
        display: flex;
        justify-content: start;
    }

    .dataTables_wrapper {
    }

        .dataTables_wrapper .dataTables_filter {
        }


        .dataTables_wrapper .dataTables_length {
        }

    div.dataTables_wrapper div.dataTables_filter input {
        width: 500px;
        height: 45px;
    }

    #trendListTable_length select {
        height: 45px;
    }
</style>
<div class="w-100 d-flex justify-content-center">
    <span id="headerTitle" class="label p-7 font-weight-bold label-xl  label-inline mr-2">Trendyol</span>
</div>

@*<a href="/urunler/TrendAddOrEdit" class="btn btn-light-primary pulse pulse-primary mr-2 float-right font-weight-bold mr-2">

        <i class="fa fa-plus"></i>

        Yeni Ürün Ekle
    </a>*@
<a data-toggle="modal" data-target="#TrendAddInfo" class="btn btn-light-success pulse pulse-success mr-2 float-right font-weight-bold mr-2">

    <i class="fa fa-plus"></i>

    Yeni Ürün Ekle
</a>
<!--SMurunlerRemove Btn-->
<div class="modal fade" id="TrendRemoveInfo">

    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">SM Urunler Remove</h2>
            </div>
            <div class="modal-body">

                <form id="TrendForm">
                    <label>Silmek İstediğine Eminmisin ?</label>
                </form>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-info" data-bs-dismiss="modal">İptal</button>

                <input type="submit" value="Sil" id="TrendModalSil" class="btn btn-danger" data-bs-dismiss="modal" />


            </div>
        </div>
    </div>

</div>
<!--SMurunlerRemove Btn-->
<!--SMurunlerRemove Btn-->
<table class="table table-head-bg table-head-borderless table-vertical-center" id="trendListTable">
    <thead>
        <tr>
            <th hidden>
                İTarih
            </th>
            <th hidden>
                Silme
            </th>
            <th hidden>
                Ayar Adı
            </th>
            <th>
                Barkod
            </th>
            <th hidden>
                Brand
            </th>
            <th hidden>
                Kargo
            </th>
            <th hidden>
                Açıklama
            </th>
            <th hidden>
                Cinsiyet
            </th>
            <th hidden>
                Resim
            </th>
            <th>
                Gün
            </th>
            <th>
                Yüzde
            </th>
            <th>
                Komisyon
            </th>
            <th>
                Gram
            </th>
            <th>
                Milyem
            </th>
            <th>
                PanoHas
            </th>
            <th>
                Liste Fiyat
            </th>
            <th hidden>
                Satış Fiyatı
            </th>
            <th hidden>
                Kategori
            </th>
            <th>
                Stok
            </th>
            <th hidden>
                Stok Kodu
            </th>
            <th hidden>
                Baslik
            </th>
            <th hidden>
                Kdv
            </th>
            <th hidden>
                Mail
            </th>
            <th hidden>
                Durum
            </th>
            <th hidden>
                UpTarih
            </th>
            <th hidden>
                Up Fiyat Tarih
            </th>
            <th>İşlemler</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            if (item.silme == false)
            {
        <tr>
            <td hidden>
                @Html.DisplayFor(modelItem => item.itarih)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.silme)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.ayarAdi)
            </td>
            <td class="shorting_1 dtr-control text-left" style="width:200px;">
                <div class="d-flex align-items-center">
                    <div class="symbol symbol-50 flex-shrink-0">
                        @if (item.resim == null || item.resim == "")
                        {
                            <div class="symbol-label bgi-size-cover" style="background-image:url('../../assets/img/gorselYok.png')">

                            </div>
                        }
                        else
                        {

                            <div class="symbol-label bgi-size-cover" style="background-image:url(@Html.DisplayFor(modelItem => item.resim))">

                            </div>
                        }
                    </div>
                    <div class="ml-3">
                        <span class="text-dark-75 font-weight-bold line-height-sm d-block pb-2">
                            @Html.DisplayFor(modelItem => item.barkod, new { @class = "label-light-success label-inline" })
                        </span>

                        @Html.DisplayFor(modelItem => item.baslik)
                    </div>
                </div>


            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.brand)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.kargo)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.aciklama)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.cinsiyet)
            </td>
            <td hidden>
                <img src="@Html.DisplayFor(modelItem => item.resim)" style="width:40px;height:40px" />
            </td>
            <td>
                @if (item.gun == null)
                {
                    <span class="label font-weight-bold label-lg label-light-danger label-inline">Boş</span>
                }
                else
                {

                    @Html.DisplayFor(modelItem => item.gun)
                }
            </td>
            <td>
                @if (item.yuzde == null)
                {
                    <span class="label font-weight-bold label-lg label-light-danger label-inline">Boş</span>
                }
                else
                {

                    @Html.DisplayFor(modelItem => item.yuzde)
                }
            </td>
            <td>
                @if (item.komisyon == null)
                {
                    <span class="label font-weight-bold label-lg label-light-danger label-inline">Boş</span>
                }
                else
                {

                    @Html.DisplayFor(modelItem => item.komisyon)
                }
            </td>
            <td>
                @if (item.gram == null)
                {
                    <span class="label font-weight-bold label-lg label-light-danger label-inline">Boş</span>
                }
                else
                {

                    @Html.DisplayFor(modelItem => item.gram)
                }
            </td>
            <td>
                @if (item.milyem == null)
                {
                    <span class="label font-weight-bold label-lg label-light-danger label-inline">Boş</span>
                }
                else
                {

                    @Html.DisplayFor(modelItem => item.milyem)
                }
            </td>
            <td>
                @if (item.panoHas == null)
                {
                    <span class="label font-weight-bold label-lg label-light-danger label-inline">Boş</span>
                }
                else
                {

                    @Html.DisplayFor(modelItem => item.panoHas)
                }
            </td>
            <td>
                @if ( item.listeFiyat == null)
                {
                    <span class="label font-weight-bold label-lg label-light-danger label-inline">Boş</span>
                }
                else
                {

                    @Html.DisplayFor(modelItem => item.listeFiyat)
                }
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.satisFiyat)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.kategori)
            </td>
            <td >
                @Html.DisplayFor(modelItem => item.adet)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.stokKodu)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.baslik)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.kdv)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.mail)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.durum)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.upTarih)
            </td>
            <td hidden>
                @Html.DisplayFor(modelItem => item.upFiyatTarih)
            </td>
            <td>
                @*<a href="@Url.Action("TrendAddOrEdit","urunler",new {id= item.otosay })" class="btn btn-sm btn-icon btn-light-primary pulse pulse-primary mr-0">
                <i class="fa fa-cog"></i>
                <span class="pulse-ring"></span>
            </a>*@
                @*<a href="#" onclick="TrendAddOrEdit(@item.otosay)" class="btn btn-sm  btn-icon btn-light-primary pulse pulse-primary mr-2">
                <i class="fa fa-cog"></i>
                <span class="pulse-ring"></span>
            </a>*@

                @*@Html.ActionLink("Detay", "CicekSepetiDetay", new { id = item.otosay }, new
            {
                @class = "btn btn-info",
                @data_toggle = "modal",
                @data_target = "#exampleModalLong"
            })*@

                <a href="@Url.Action("TrendyolDetails", "urunler", new { id = item.otosay })" class="btn btn-sm btn-icon btn-light-info pulse pulse-info mr-0">
                    <i class="fa fa-info"></i>
                    <span class="pulse-ring"></span>
                </a>


                @*<a href="@Url.Action("TrendyolRemove","urunler",new {id= item.otosay })" id="TrendyolRemove" class="btn btn-sm btn-icon btn-light-danger pulse pulse-danger mr-0">
                <i class="fa fa-trash"></i>
                <span class="pulse-ring"></span>
            </a>*@
                <a id="TrendRemoveInfo" onclick="Rem(@item.otosay)" class="btn btn-sm btn-icon btn-light-danger pulse pulse-danger mr-2">
                    <i class="fa fa-trash"></i>
                    <span class="pulse-ring"></span>
                </a>


                @*<a href="#" id="showModal" class="btn btn-danger" onclick="Remove(@item.otosay)">Sil</a>*@


            </td>
        </tr>
            }
        }
    </tbody>
</table>


<script>

    var Rem = function (_id) {


        Swal.fire({
            title: 'Uyarı !!!',
            text: "Silmek istediğine emin misin ?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Sil',
            cancelButtonText: 'İptal',
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {

                $.ajax({
                    type: "POST",
                    url: "/Urunler/TrendyolRemove",
                    data: { id: _id },
                    success: function (result) {
                        if (result) {

                            $('#TrendRemoveID').val(null);
                            window.location.href = "/urunler/trendlist";

                        }
                        else {
                            alertify.error("Hata oluştu silme işlemi sırasında");
                        }
                    }
                });
            }
        })

    };



    $(document).ready(function () {
        //Add
        $("#TrendModal_btnAdd").click(function () {
            var DataForm = $("#TrendAddForm").serialize();
            var barkodKont = $("#barkodKontrol").val();
            if (barkodKont == null || barkodKont == "") {

                toastr.warning("Barkod numarası girmeden ekleme işlemi yapamazsın !!!");
            } else {
                $.ajax({
                    type: "POST",
                   // url: "/Urunler/TrendyolDetails",
                    url:"http://localhost:44308/api/trend_aktifurunler",
                    data: DataForm,
                    success: function () {
                        toastr.success("Ekleme işlemi gerçekleşti")
                        window.location.href = "/urunler/trendlist";

                    },
                    error: function () {
                        toastr.info("Barkod numarası kullanılmaktadır.");
                    }
                });
            }
        });
        $('#trendListTable').DataTable({
            "dom": "<'row tableSearchHeader'<'tableSearch col-lg-10 col-md-10 col-xs-12'f><'tablePageNumber col-lg-2 col-md-2 col-xs-12'l>>" +
                "<'row'<'col-sm-12'tr>>" +
                "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
            language: {
                search: "_INPUT_",
                searchPlaceholder: "Arama...",
                lengthMenu: " _MENU_ ",
                zeroRecords: "Kayıt bulunamadı",
                info: "Gösterilen Sayfa : _PAGE_ Sayfalar : _PAGES_",
                infoEmpty: "Kayıt yok",
                infoFiltered: "(Toplam _MAX_ kayıttan filtrelendi)"
            },
            columnDefs: [{ orderable: false, targets: [1, 26, 8] }],
        });
    })

     var TrendAddOrEdit = function (Id) {
        $('#TrendAddOrEditID').val(Id);
        var url = '@Url.Action("TrendAddOrEdit", "Urunler")/' + Id;
            $.get(url, function (data) {
                $('#myModal').html(data);
                $('#myModal').modal('show');
            })
    }


    var Confirm = function (Id) {
        $('#TrendRemoveID').val(Id);
        $('#TrendRemoveInfo').modal('show');
    }


    $(document).ready(function () {
        $('#TrendModalSil').click(function () {
            var _id = $('#TrendRemoveID').val();

            $.ajax({
                type: "POST",
                url: "/Urunler/TrendyolRemove",
                data: { id: _id },
                success: function (result) {
                    if (result) {
                        Swal.fire({
                            title: "Silindi",
                            text: "Dosya başarıyla silindi",
                            icon: "success",
                            buttonsStyling: false,
                            showConfirmButton: false
                        });
                        $('#TrendRemoveInfo').modal('hide');
                        $('#TrendRemoveID').val(null);
                        window.location.href = "/urunler/trendlist";

                    }
                    else {
                        alertify.error("Hata oluştu silme işlemi sırasında");
                    }
                }
            });
        });
    })
</script>


<!--Update Modal-->
@*<button type="button" class="btn btn-secondary" id="#">Modal</button>*@
<div class="modal" id="myModal"> </div>
<!--Update Modal-->
<input type="hidden" id="TrendAddOrEditID" />

@*</div>*@
<!--GET ID-->
<input type="hidden" id="TrendRemoveID" />
<!--GET ID-->
<!-- SM URUNLER Add-->
<!--BTN-->
@*<button class="btn btn-light-primary" data-toggle="modal" data-target="#SM_UrunlerAddInfo">Modal add</button>*@
<!--BTN-->
<div class="modal fade" id="TrendAddInfo">

    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title center-block" id="modalTitle">Trendyol Ürün Ekle</h3>
            </div>
            <div class="modal-body">

                <form id="TrendAddForm" method="post" action="/urunler/TrendyolDetails">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <input name="itarih" class="form-control" placeholder="İ Tarih" />
                            </div>
                            <div class="col-md-3">
                                <select name="silme" class="form-control">
                                    <option selected>Silme İşlem</option>
                                    <option value="False">False</option>
                                    <option value="True">True</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <input name="ayarAdi" class="form-control" placeholder="Ayar Adı" />
                            </div>
                            <div class="col-md-3">
                                <input name="ayar" class="form-control" placeholder="Ayar" />
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-12">
                                <input name="aciklama" class="form-control" placeholder="Açıklama" />
                            </div>
                        </div>

                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <input name="barkod" id="barkodKontrol" class="form-control" placeholder="Barkod" />
                            </div>
                            <div class="col-md-3">
                                <input name="brand" class="form-control" placeholder="Brand" />
                            </div>
                            <div class="col-md-3">
                                <input name="kargo" class="form-control" placeholder="Kargo" />
                            </div>
                            <div class="col-md-3">
                                <select name="cinsiyet" class="form-control">
                                    <option selected>Cinsiyet İşlem</option>
                                    <option value="Unisex">Unisex</option>
                                    <option value="Erkek">Erkek</option>
                                    <option value="Kadın">Kadın</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <input name="resim" class="form-control" placeholder="Resim" />
                            </div>
                            <div class="col-md-3">
                                <input name="listeFiyat" class="form-control" placeholder="Liste Fiyat" />
                            </div>
                            <div class="col-md-3">
                                <input name="satisFiyat" class="form-control" placeholder="Satis Fiyat" />
                            </div>
                            <div class="col-md-3">
                                <input name="kategori" class="form-control" placeholder="Kategori" />
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <input name="adet" class="form-control" placeholder="Adet" />
                            </div>

                            <div class="col-md-3">
                                <input name="stokKodu" class="form-control" placeholder="Stok Kodu" />
                            </div>
                            <div class="col-md-3">
                                <input name="baslik" class="form-control" placeholder="Baslik" />
                            </div>
                            <div class="col-md-3">
                                <input name="kdv" class="form-control" placeholder="Kdv" />
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <input type="text" name="mail" class="form-control" placeholder="Mail" />
                            </div>

                            <div class="col-md-3">
                                <select class="form-control" name="durum">
                                    <option selected>Durum İşlem</option>
                                    <option value="True">True</option>
                                    <option value="False">False</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <input name="upTarih" class="form-control" placeholder="Up Tarih" />
                            </div>
                            <div class="col-md-3">
                                <input name="upFiyatTarih" class="form-control" placeholder="Up Fiyat Tarih" />
                            </div>

                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <input type="text" name="panoHas" class="form-control" placeholder="PanoHas" />
                            </div>
                            <div class="col-md-3">
                                <input name="milyem" class="form-control" placeholder="Milyem" />
                            </div>
                            <div class="col-md-3">
                                <input name="gram" class="form-control" placeholder="Gram" />
                            </div>
                            <div class="col-md-3">
                                <input name="komisyon" class="form-control" placeholder="Komisyon" />
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <input type="text" name="gun" class="form-control" placeholder="Gün" />
                            </div>
                            <div class="col-md-3">
                                <input type="text" name="yuzde" class="form-control" placeholder="Yüzde" />
                            </div>

                        </div>
                    </div>


                </form>

            </div>
            <div class="modal-footer">
                <a href="#" class="btn btn-info" data-dismiss="modal">İptal</a>

                <button type="submit" id="TrendModal_btnAdd" class="btn btn-success">Ekle</button>


            </div>
        </div>
    </div>

</div>

<!-- SM URUNLER Add-->